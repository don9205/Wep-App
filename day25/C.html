<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="//code.jquery.com/jquery-3.3.1.js"></script>
    <title>Document</title>
</head>
<body>
    <div class="box">
        <input type="text" class="input"> <br>
    </div>
    <button class="plus">추가</button>
    <button id="btnOk">확인</button>

    <script>
    $(document).ready(function(){
            var plus = '<input type="text" class="input"> <br>'
            $('.plus').click(function(){
                $('.box').append(plus);
            });
     
        $('#btnOk').click(function(){
            var data = new String();
            var data2 = new Array();
            $('.input').each(function(){
                var tmpData = $(this).val();
                if(tmpData != ""){
                    data += ','+tmpData; 
                    data2.push(tmpData);
                }
            });

            //문자열을 이용한 처리
            // 첫번째 데이터의 ,를 빼기 위한 작업
            data = data.substr(1);
            $(opener.document).find('#fruit').val(data);
            // opener.document.getElementById('fruit).value=data;
            // opener.document.getElementsByClassName('fruit')[0].value=data;

            //배열을 이용한 처리
            // 기본적으로 배열은 ,가 들어가지만
            // join(구분자) : 배열의 각 원소들을 문자열로 바꾸는데 원소들 사이에 구분자를 입력
            $(opener.document).find('#fruit').val(data2.join(','));
            // setTimeout(function(){window.close()},2000); 확인을 누르면 2초 지연한 뒤 창이 닫힘
            opener.$('#fruit').trigger('change');
        });


        var Pdata = $(opener.document).find('#fruitC').val()
        // split : 문자열에서 ,를 기준ㄴ으로 문자열을 잘라 배열로 만드는 함수
        var Pslice = Pdata.split(',');
        var str = "";
        for(var i=0; i<Pslice.length;i++){
            str += '<input type="text" value="'+Pslice[i] + '"readonly><br>'
        }
        $('.box').html(str);
        // var Cdata = $('.input').val()
        //    Cdata = Pdata;
        // $('.input').val(Cdata);


        
    });
    </script>
    
</body>
</html>